<h1 id="tests-specification-for-oscore-group-communication">Tests Specification for OSCORE Group Communication</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#notes">Notes</a></li>
<li><a href="#security-contexts-and-resources">Security Contexts and Resources</a>
<ol type="1">
<li><a href="#client-sec-A1">Security Context A1: Client</a></li>
<li><a href="#server-sec-A2">Security Context A2: Client</a></li>
<li><a href="#client-sec-A3">Security Context A3: Client</a></li>
<li><a href="#server-sec-A4">Security Context A4: Client</a></li>
<li><a href="#server-sec-B1">Security Context B1: Server</a></li>
<li><a href="#server-sec-B2">Security Context B2: Server</a></li>
<li><a href="#server-sec-B3">Security Context B3: Server</a></li>
<li><a href="#server-sec-B4">Security Context B4: Server</a></li>
<li><a href="#resources">Resources</a></li>
</ol></li>
<li><a href="#env-setup">Set up the environment</a>
<ol type="1">
<li><a href="#test-0a">Test 0a</a></li>
<li><a href="#test-0b">Test 0b</a></li>
</ol></li>
<li><a href="#correct-oscore-use">Correct OSCORE use</a>
<ol type="1">
<li><a href="#client">test</a>
<ol type="1">
<li><a href="#test-1a">Test 1a</a></li>
<li><a href="#test-1b">Test 1b</a></li>
<li><a href="#test-2a">Test 2a</a></li>
<li><a href="#test-2b">Test 2b</a></li>
<li><a href="#test-3a">Test 3a</a></li>
<li><a href="#test-3b">Test 3b</a></li>
<li><a href="#test-4a">Test 4a</a></li>
<li><a href="#test-4b">Test 4b</a></li>
</ol></li>
</ol></li>
</ol>
<h2 id="notes">1. Notes</h2>
<p>CoAP Version is 1 in all the tests.</p>
<p>The client and server may optionally display external_aad and COSE object (before and after compression) to simplify debugging.</p>
<p>It is recommended to have tested OSCORE functionalities (see TBD link) before running these tests.</p>
<p>Note that Group Communication (TBD link) mandates the use of NON for requests. This specification recommends the use of NON for responses as well.</p>
<p>Note that the CoAP Token timeout needs to be configured to run the tests with multiple responses (see TBD). This specification recommends using a timeout of appr. 30 seconds.</p>
<p>Most of the tests can be run between 2 nodes. A few tests require 3/4 nodes.</p>
<p>Although these specifications test the implementation of group OSCORE, this version does not rely on multicast communication. The test specified below can in fact be run on unicast between the nodes, to test the group OSCORE implementation features.</p>
<h3 id="addresses">Addresses</h3>
<p>31.133.136.216 - Jim</p>
<p>31.133.155.197 - Jim</p>
<p>31.133.136.213 - Rikard</p>
<p>31.133.156.244 - Peter</p>
<h3 id="jims-modifications-from-draft--05">Jim’s Modifications from draft -05</h3>
<ol type="1">
<li><p>Section 3.1.2 - The fields OSCORE_option and options are swapped in the aad_array structure. This only changes the external_aad for signing and not for encryption.</p></li>
<li><p>Section 9.2 - The items are wrapped in an array when more than one elemet exists. This is reflected in the fields below.</p></li>
</ol>
<h2 id="configuration-security-contexts-and-resources">2. Configuration, Security Contexts and Resources</h2>
<h3 id="group-sec-1">Group Security Context #1: ECDSA</h3>
<ul>
<li>Common Context:
<ul>
<li>Master Secret: 0x0102030405060708090a0b0c0d0e0f10 (16 bytes)</li>
<li>Master Salt: 0x9e7ca92223786340 (8 bytes)</li>
<li>Common IV: 0x0x2ca58fb85ff1b81c0b7181b85e (13 bytes)</li>
<li>ID Context: 0x37cbf3210017a2d3 (8 bytes)</li>
<li>Par Countersign: 0x26</li>
<li>Par Countersign Key: 0x822601</li>
</ul></li>
<li>Entity #1
<ul>
<li>Sender ID: 0xa1 (0 byte)</li>
<li>Sender Key: 0xaf2a1300a5e95788b356336eeecd2b92 (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: 0x2ca58fb85ff1b81c0b7181b85e (using Partial IV: 00)</li>
<li>Signing Key: {1: 2, -1: 1, -2: h’E2A7DC0C5D23831A4F52FBFF759EF01A6B3A7D58694774D6E8505B31A351D6C4’, -3: h’F8CA44FEDC6C322D0946FC69AE7482CD066AD11F34AA5F5C63F4EADB320FD941’, -4: h’469C76F26B8D9F286449F42566AB8B8BA1B3A8DC6E711A1E2A6B548DBE2A1578’}</li>
</ul></li>
<li>Entity #2
<ul>
<li>Recipient ID: 0xb1 (1 byte)</li>
<li>Recipient Key: 0xe39a0c7c77b43f03b4b39ab9a268699f (16 bytes)</li>
<li>Recipient IV: 0x2da58fb85ff1b81d0b7181b85e (using Partial IV: 00)</li>
<li>Signing Key: {1: 2, -1: 1, -2: h’5BC9E40487130A030D37F8162A17EF14CC9E96019A307DBADC90691C563D766B’, -3: h’1D6EB75E5585C1B19051A84DCC7608B604095BE857BA37727D65343FEF616DC3’, -4: h’BB39276D3A04E14E4421A56689F7CAFEC1D08DF3029CB7CED968283A084B7E38’}</li>
</ul></li>
<li>Entity #3
<ul>
<li>Recipient ID: 0xb2 (1 byte)</li>
<li>Recipient Key: TODO (16 bytes)</li>
<li>Recipient IV: TODO (using Partial IV: TODO)</li>
<li>Signing Key: {1: 2, -1: 1, -2: h’57CF4C3DBF16216B1009D30F3C7C408A7144E63FEC18C561970F2EDC6EEA993A’, -3: h’B20EF6B0518D25CBEB2EF5DB8E12DE056B4075B3F4986781385B90A625B04AC7’, -4: h’C96D7F08EF1FE13BC311CAB7FC5C5CBA3693004293C638F250EB6EA122E7C879’}</li>
</ul></li>
</ul>
<h3 id="group-sec-2">Group Security Context #2: EdDSA</h3>
<ul>
<li>Common Context:
<ul>
<li>Master Secret: 0x102030405060708090a0b0c0d0e0f001 (16 bytes)</li>
<li>Master Salt: 0xe9c79a2232873604 (8 bytes)</li>
<li>ID Context: 0x73bc3f1200712a3d (8 bytes)</li>
<li>Common IV: 0x5B188ED0BD4B9B046B818BE37E (13 bytes)</li>
<li>Par Countersign: 0x06</li>
<li>Par Countersign Key: 0x820106</li>
</ul></li>
<li>Entity #1:
<ul>
<li>Signing Key: {1: 1, -1: 6, -2: h’4C5E5A898AFC77D9C90773D9B4F5E7B378605753F9BA9E8A62488C64E1A524B0’, -4: h’C9AFCF6610BAB69A7E72B78B6D364BE86F12CF293523DA51433B09A799FF0F62’}</li>
</ul></li>
<li>Entity #2:
<ul>
<li>Signing Key: {1: 1, -1: 6, -2: h’90F28C4CC63A56574F1873B802B587F9CE05E718887B3411E8EC97B9C28E7227’, -4: h’732BA0EF6CAC00A91E97BDA18E1E4D94C4C75988676BE43B7B7664A1D5B2651F’}</li>
</ul></li>
<li>Entity #3:
<ul>
<li>Signing Key: {1: 1, -1: 6, -2: h’91BDA65809E1D37B74E7B9AB5797479D47AF6E8CE6C4940AAA468562F04CE715’, -4: h’00FC63AD4D5C3C4B645B3DE47E937F419EE3FA58B41BEBE8FB7E7429520AD06B’}</li>
</ul></li>
<li>Entity #4:
<ul>
<li>Signing Key: {1: 1, -1: 6, -2: h’2A279191227491C92E9C5AEDCF72F5C73E78E19C7E77172B4FEFCE09018AEFD4’, -4: h’D744189028C8F2652EBBF3576B4CB740926B25DA087043E978AE570AAD333495’}</li>
</ul></li>
<li>Jim’s Client
<ul>
<li>Sender ID: 0xa1 (1 byte)</li>
<li>Sender Key: TBD (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Signing Key: Entity 1 Signing Key</li>
</ul></li>
<li>Jim’s Server 1
<ul>
<li>Sender ID: 0xa2 (1 byte)</li>
<li>Sender Key: 0x8FDCB65DB23B63D9338A276DF844A371 (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: 0x5A188ED0BD4B9BA66B818BE37E (using Partial IV: 00)</li>
<li>Signing Key: Entity 1 Signing Key</li>
</ul></li>
<li>Jim’s Server 2
<ul>
<li>Sender ID: 0xa3 (1 byte)</li>
<li>Sender Key: TBD (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Signing Key: Entity 1 Signing Key</li>
</ul></li>
<li>Rikard’s Client
<ul>
<li>Sender ID: 0xb1 (1 byte)</li>
<li>Sender Key: 0xA09B63097B20B43A895B5A65D709BA81 (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: 0x5A188ED0BD4B9BB56B818BE37E (using Partial IV: 00)</li>
<li>Signing Key: Entity 2 Signing Key</li>
</ul></li>
<li>Rikard’s Server 1
<ul>
<li>Sender ID: 0xb2 (1 byte)</li>
<li>Sender Key: TBD (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Signing Key: Entity 2 Signing Key</li>
</ul></li>
<li>Rikard’s Server 2
<ul>
<li>Sender ID: 0xb3 (1 byte)</li>
<li>Sender Key: TBD (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Signing Key: Entity 2 Signing Key</li>
</ul></li>
<li>Peter’s Client
<ul>
<li>Sender ID: 0xc1 (1 byte)</li>
<li>Sender Key: E9BB12DE9ED96975D78CEBF59A5F87E7 (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Public Signing Key: 0x508AFC1C29037EF3614D63AF87E1EA31D891D76B1F906098AF8FA39BBE874019 (32 bytes)</li>
</ul></li>
<li>Peter’s Server
<ul>
<li>Sender ID: 0xc2 (1 byte)</li>
<li>Sender Key: TBD (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Public Signing Key: TBD</li>
</ul></li>
</ul>
<h3 id="server-sec-b3">Security Context B3: Server</h3>
<p>(incorrect sec ctx) modified Sender Key</p>
<ul>
<li>Common Context:
<ul>
<li>Master Secret: 0x0102030405060708090a0b0c0d0e0f10 (16 bytes)</li>
<li>Master Salt: 0x9e7ca92223786340 (8 bytes)</li>
<li>Common IV: 0x2ca58fb85ff1b81c0b7181b85e (13 bytes)</li>
<li>ID Context: 0x37cbf3210017a2d3 (8 bytes)</li>
</ul></li>
<li>Sender Context:
<ul>
<li>Sender Id: 0xb3 (1 byte)</li>
<li>Sender Key: TBD (16 bytes) *** Key needs to be manually modified</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Private Key TBD</li>
</ul></li>
<li>Recipient Context:
<ul>
<li>Recipient Id: 0xa1 (0 byte)</li>
<li>Recipient Key: 0xaf2a1300a5e95788b356336eeecd2b92 (16 bytes)</li>
<li>Recipient IV: 0x2ca58fb85ff1b81c0b7181b85e (using Partial IV: 00)</li>
<li>Public Key TBD</li>
</ul></li>
</ul>
<h3 id="server-sec-b4">Security Context B4: Server</h3>
<p>(incorrect sec ctx) different Private Key</p>
<ul>
<li>Common Context:
<ul>
<li>Master Secret: 0x0102030405060708090a0b0c0d0e0f10 (16 bytes)</li>
<li>Master Salt: 0x9e7ca92223786340 (8 bytes)</li>
<li>Common IV: 0x2ca58fb85ff1b81c0b7181b85e (13 bytes)</li>
<li>ID Context: 0x37cbf3210017a2d3 (8 bytes)</li>
</ul></li>
<li>Sender Context:
<ul>
<li>Sender Id: 0xb4 (1 byte)</li>
<li>Sender Key: TBD (16 bytes)</li>
<li>Sender Seq Number: 00</li>
<li>Sender IV: TBD (using Partial IV: 00)</li>
<li>Private Key TBD *** Key does not match Sec Ctx A Public Key</li>
</ul></li>
<li>Recipient Context:
<ul>
<li>Recipient Id: 0xa1 (0 byte)</li>
<li>Recipient Key: 0xaf2a1300a5e95788b356336eeecd2b92 (16 bytes)</li>
<li>Recipient IV: 0x2ca58fb85ff1b81c0b7181b85e (using Partial IV: 00)</li>
<li>Public Key TBD</li>
</ul></li>
</ul>
<h3 id="resources">Resources</h3>
<p>The list of resources the OSCORE-aware server must implement is the following:</p>
<ul>
<li>/oscore/hello/coap : authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<hr />
<h2 id="env-setup">3. Set up the environment</h2>
<h3 id="test-0a">3.1. Identifier: TEST_0a</h3>
<p><strong>Objective</strong> : Verify that CoAP exchange works. Perform a simple GET transaction using COAP, Content-Format and Uri-Path option (Client side)</p>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request including:</p>
<ul>
<li>Uri-Path : /oscore/hello/coap</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td>Client serializes the request</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response and continues the CoAP processing expected; expected: 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-0b">3.2. Identifier: TEST_0b</h4>
<p><strong>Objective</strong> : Verify that CoAP exchange works. Perform a simple GET transaction using COAP, Content-Format and Uri-Path option (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/coap : authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request including:</p>
<ul>
<li>Uri-Path = /oscore/hello/coap</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td>Server parses the request and continues the CoAP processing</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<h2 id="client">4. Several Recipient Contexts on Client</h2>
<p>In these tests, the node has several recipient contexts. The goal is to test the retrieval/derivation of recipient contexts on the client.</p>
<p>For these tests, all parties need to agree on a signature algorithm to be used and from that select the group context to be used.</p>
<h3 id="correct-group-oscore-use">4.1 Correct Group OSCORE Use</h3>
<h4 id="test-1a">4.1.1. Identifier: TEST_1a</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction, where the client and server retrieve a recipient context that they have stored in memory. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: Client takes the key for Entity #1</p>
<ul>
<li>Sequence number received not in client’s replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td><p>Client serializes the request, which is a POST request, with:</p>
<ul>
<li>Object-Security option: kid = 0xa1</li>
<li><p>Payload: ciphertext including:</p>
<pre><code>* Code: GET
* Uri-Path : /oscore/hello/1</code></pre></li>
</ul></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response; expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0xb1</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="odd">
<td>4</td>
<td>Verify</td>
<td>Client successfully retrieves correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="even">
<td>6</td>
<td>Check</td>
<td><p>Client parses the decrypted response and continues the CoAP processing; expected 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-1b">4.1.2. Identifier: TEST_1b</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction, where the client and server retrieve a recipient context that they have stored in memory. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: Server takes the roll of Entity #2 with:</p>
<ul>
<li>Sequence number received not in server’s replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Check</td>
<td><p>Server parses the request; expected: 0.02 POST with:</p>
<ul>
<li>Object-Security option: kid = 0xa1</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="even">
<td>4</td>
<td>Verify</td>
<td>Server successfully retrieves correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Check</td>
<td><p>Server parses the request and continues the CoAP processing; expected: CoAP GET request, including:</p>
<ul>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0xb1</li>
<li><p>Payload: ciphertext including:</p>
<ul>
<li>Code: 2.05 Content Response</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>8</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<h4 id="test-2a">4.1.3. Identifier: TEST_2a</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction, where the client receives a Recipient Id that it does not have in memory, and succesfully derives the Recipient Context for it. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number received not in client’s replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td><p>Client serializes the request, which is a POST request, with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li><p>Payload: ciphertext including:</p>
<pre><code>* Code: GET
* Uri-Path : /oscore/hello/1</code></pre></li>
</ul></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response; expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x02</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Client successfully derives a new Recipient Context from received Recipient Id = 0x02 ; Client decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="even">
<td>6</td>
<td>Check</td>
<td><p>Client parses the decrypted response and continues the CoAP processing; expected 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-2b">4.1.4. Identifier: TEST_2b</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction, where the client receive a Recipient Id that it does not have in memory, and derives the Recipient Context for it. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec">Security Context C</a>, with:</p>
<ul>
<li>Sequence number received not in server’s replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Check</td>
<td><p>Server parses the request; expected: 0.02 POST with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="even">
<td>4</td>
<td>Verify</td>
<td>Server successfully retrieves correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Check</td>
<td><p>Server parses the request and continues the CoAP processing; expected: CoAP GET request, including:</p>
<ul>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x02</li>
<li><p>Payload: ciphertext including:</p>
<ul>
<li>Code: 2.05 Content Response</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>8</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<h4 id="test-3a">4.1.5. Identifier: TEST_3a</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction, where the server receives a Recipient Id that it does not have in memory, and succesfully derives the Recipient Context for it. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec-a">Security Context A2</a>, with:</p>
<ul>
<li>Sequence number received not in client’s replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td><p>Client serializes the request, which is a POST request, with:</p>
<ul>
<li>Object-Security option: kid = 0x00</li>
<li><p>Payload: ciphertext including:</p>
<pre><code>* Code: GET
* Uri-Path : /oscore/hello/1</code></pre></li>
</ul></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response; expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x01</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Client successfully retrieves correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="even">
<td>6</td>
<td>Check</td>
<td><p>Client parses the decrypted response and continues the CoAP processing; expected 2.05 Content Response with:</p>
<ul>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-3b">4.1.6. Identifier: TEST_3b</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction, where the server receive a Recipient Id that it does not have in memory, and derives the Recipient Context for it. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec-B">Security Context B</a>, with:</p>
<ul>
<li>Sequence number received not in server’s replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Check</td>
<td><p>Server parses the request; expected: 0.02 POST with:</p>
<ul>
<li>Object-Security option: kid = 0x00</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="even">
<td>4</td>
<td>Verify</td>
<td>Server successfully derives a new Recipient Context from received Recipient Id = 0x00 ; Client decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Check</td>
<td><p>Server parses the request and continues the CoAP processing; expected: CoAP GET request, including:</p>
<ul>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x01</li>
<li><p>Payload: ciphertext including:</p>
<ul>
<li>Code: 2.05 Content Response</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>8</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<h3 id="incorrect-group-oscore-use">4.2 Incorrect Group OSCORE Use</h3>
<h4 id="test-4a">4.2.1. Identifier: TEST_4a</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction where the client receives a Recipient Id that it does not have in memory, and derives the Recipient Context for it, but decryption fails. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number received not in client’s replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td><p>Client serializes the request, which is a POST request, with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li><p>Payload: ciphertext including:</p>
<pre><code>* Code: GET
* Uri-Path : /oscore/hello/1</code></pre></li>
</ul></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response; expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x03</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Client successfully derives a new Recipient Context from received Recipient Id = 0x03 ; Client tries to decrypt the message: OSCORE verification fail</td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-4b">4.2.2. Identifier: TEST_4b</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction where the client receive a Recipient Id that it does not have in memory, and derives the Recipient Context for it, but decryption fails. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec-D">Security Context D</a>, with:</p>
<ul>
<li>Sequence number received not in server’s replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Check</td>
<td><p>Server parses the request; expected: 0.02 POST with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="even">
<td>4</td>
<td>Verify</td>
<td>Server successfully retrieve correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Check</td>
<td><p>Server parses the request and continues the CoAP processing; expected: CoAP GET request, including:</p>
<ul>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x03</li>
<li><p>Payload: ciphertext including:</p>
<ul>
<li>Code: 2.05 Content Response</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>8</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<p>***** Server</p>
<h4 id="test-5a">4.2.3. Identifier: TEST_5a</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction where the server receives a Recipient Id that it does not have in memory, and derives the Recipient Context for it, but decryption fails. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A3</a>, with:</p>
<ul>
<li>Sequence number received not in client’s replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td><p>Client serializes the request, which is a POST request, with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li><p>Payload: ciphertext including:</p>
<pre><code>* Code: GET
* Uri-Path : /oscore/hello/1</code></pre></li>
</ul></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response; expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x03</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Client successfully derives a new Recipient Context from received Recipient Id = 0x03 ; Client tries to decrypt the message: OSCORE verification fail</td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-5b">4.2.4. Identifier: TEST_5b</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction where the client receive a Recipient Id that it does not have in memory, and derives the Recipient Context for it, but decryption fails. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec-D">Security Context D</a>, with:</p>
<ul>
<li>Sequence number received not in server’s replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Check</td>
<td><p>Server parses the request; expected: 0.02 POST with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="even">
<td>4</td>
<td>Verify</td>
<td>Server successfully retrieve correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Check</td>
<td><p>Server parses the request and continues the CoAP processing; expected: CoAP GET request, including:</p>
<ul>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x03</li>
<li><p>Payload: ciphertext including:</p>
<ul>
<li>Code: 2.05 Content Response</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>8</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<h4 id="test-6a">4.2.5. Identifier: TEST_6a</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction where the client receives a Recipient Id that it does not have in memory, and derives the Recipient Context for it, but signature verification fails. (Client side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>client security context</em>: <a href="#client-sec">Security Context A</a>, with:</p>
<ul>
<li>Sequence number received not in client’s replay window</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Check</td>
<td><p>Client serializes the request, which is a POST request, with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li><p>Payload: ciphertext including:</p>
<pre><code>* Code: GET
* Uri-Path : /oscore/hello/1</code></pre></li>
</ul></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Verify</td>
<td>Client displays the sent packet</td>
</tr>
<tr class="even">
<td>4</td>
<td>Check</td>
<td><p>Client parses the response; expected: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x04</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Verify</td>
<td>Client successfully derives a new Recipient Context from received Recipient Id = 0x04 ; Client decrypts the message successfully; Client verifies signature: signature verification fails</td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Client displays the received packet</td>
</tr>
</tbody>
</table>
<h4 id="test-6b">4.2.6. Identifier: TEST_6b</h4>
<p><strong>Objective</strong> : Perform an OSCORE Group transaction where the client receives a Recipient Id that it does not have in memory, and derives the Recipient Context for it, but signature verification fails. (Server side)</p>
<p><strong>Configuration</strong> :</p>
<p><em>server security context</em>: <a href="#server-sec-E">Security Context E</a>, with:</p>
<ul>
<li>Sequence number received not in server’s replay window</li>
</ul>
<p><em>server resources</em>:</p>
<ul>
<li>/oscore/hello/1 : protected resource, authorized method: GET, returns the string “Hello World!” with content-format 0 (text/plain)</li>
</ul>
<p><strong>Test Sequence</strong></p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 14%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stimulus</td>
<td><p>The client is requested to send a CoAP GET request protected with OSCORE, including:</p>
<ul>
<li>Object-Security option</li>
<li>Uri-Path = /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>2</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Check</td>
<td><p>Server parses the request; expected: 0.02 POST with:</p>
<ul>
<li>Object-Security option: kid = 0x</li>
<li>Payload</li>
</ul></td>
</tr>
<tr class="even">
<td>4</td>
<td>Verify</td>
<td>Server successfully retrieve correct Recipient Context and decrypts the message: OSCORE verification succeeds</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Check</td>
<td><p>Server parses the request and continues the CoAP processing; expected: CoAP GET request, including:</p>
<ul>
<li>Uri-Path : /oscore/hello/1</li>
</ul></td>
</tr>
<tr class="even">
<td>6</td>
<td>Verify</td>
<td>Server displays the received packet</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Check</td>
<td><p>Server serialize the response correctly, which is: 2.04 Changed Response with:</p>
<ul>
<li>Object-Security option: kid = 0x04</li>
<li><p>Payload: ciphertext including:</p>
<ul>
<li>Code: 2.05 Content Response</li>
<li>Content-Format = 0 (text/plain)</li>
<li>Payload = “Hello World!”</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>8</td>
<td>Verify</td>
<td>Server displays the sent packet</td>
</tr>
</tbody>
</table>
<hr />
